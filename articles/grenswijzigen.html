<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Grenswijzigen â€¢ grenswijzigen</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Grenswijzigen">
<meta name="description" content="Begin hier voor een uitleg rondom `grenswijzigen` en de situatie rondom  wijken en gemeenten.
">
<meta property="og:description" content="Begin hier voor een uitleg rondom `grenswijzigen` en de situatie rondom  wijken en gemeenten.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">grenswijzigen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/grenswijzigen.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="grenswijzigen_files/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">
<script src="grenswijzigen_files/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="grenswijzigen_files/d3-4.9.1/d3.min.js"></script><script src="grenswijzigen_files/sankey-1/sankey.js"></script><script src="grenswijzigen_files/sankeyNetwork-binding-0.4.1/sankeyNetwork.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Grenswijzigen</h1>
                        <h4 data-toc-skip class="author">Hans Weda</h4>
            
      

      <div class="d-none name"><code>grenswijzigen.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://reidhin.github.io/grenswijzigen/">grenswijzigen</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introductie">Introductie<a class="anchor" aria-label="anchor" href="#introductie"></a>
</h2>
<p>Het grondgebied van Nederland kan op diverse manieren worden
opgedeeld. De opdeling waar het in deze repository over gaat is de
opsplitsing in gemeenten, wijken en buurten. Daarbij geldt dat buurten
optellen tot wijken en wijken optellen tot gemeenten.</p>
<p>Deze indeling ligt niet vast. Het aantal gemeenten neemt de laatste
jaren af door fusies. Een grotere gemeente kan taken die worden
toegewezen aan gemeenten gemakkelijker oppakken. Het aantal wijken neemt
geleidelijk aan toe. Een gemeente kan zelf bepalen hoe zij hun
grondgebied willen opdelen in wijken en buurten. Wellicht doordat het
aantal gemeenten af neemt, is er behoefte een gemeente op te delen in
meer wijken.</p>
<p>Door deze ontwikkelingen wijzigen de grenzen van gemeenten en wijken
regelmatig . Dat heeft consequenties als men de huidige wijkkenmerken
wil vergelijken met het verleden. Immers, de huidige wijk bestond
mogelijk nog niet in voorgaande jaren. Daarmee is het lastig om trends
in de ontwikkelingen in wijkkenmerken scherp te ontwaren. Bij
wijkkenmerken kan men bijvoorbeeld denken aan het aandeel 65-plussers,
de gemiddelde huishoudgrootte of de gemiddelde huizenprijs in een
wijk.</p>
<p>Het package <code>Grenswijzigen</code> helpt om te gaan met deze
problematiek.</p>
</div>
<div class="section level2">
<h2 id="achtergrond">Achtergrond<a class="anchor" aria-label="anchor" href="#achtergrond"></a>
</h2>
<p>Bij het CBS is veel data te vinden. Voor dit onderwerp zijn we met
name geinteresseerd in cijfers rondom wijken en gemeenten. Binnen het
CBS betreft het bijvoorbeeld onderstaande tabellen:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/edwindj/cbsodataR" class="external-link">cbsodataR</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">df.catalog</span> <span class="op">&lt;-</span> <span class="fu">cbsodataR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cbsodataR/man/cbs_get_datasets.html" class="external-link">cbs_get_datasets</a></span><span class="op">(</span>catalog<span class="op">=</span><span class="st">"CBS"</span><span class="op">)</span></span>
<span><span class="va">df.catalog</span> <span class="op">&lt;-</span> <span class="va">df.catalog</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"Kerncijfers wijken en buurten \\d{4}$"</span>, <span class="va">df.catalog</span><span class="op">$</span><span class="va">Title</span><span class="op">)</span>, </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Identifier"</span>, <span class="st">"Title"</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span><span class="va">df.catalog</span><span class="op">$</span><span class="va">Jaar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/regmatches.html" class="external-link">regmatches</a></span><span class="op">(</span><span class="va">df.catalog</span><span class="op">$</span><span class="va">Title</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">regexpr</a></span><span class="op">(</span><span class="st">"\\d{4}"</span>, <span class="va">df.catalog</span><span class="op">$</span><span class="va">Title</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df.catalog</span></span>
<span><span class="co">#&gt;      Identifier                              Title Jaar</span></span>
<span><span class="co">#&gt; 1080   85984NED Kerncijfers wijken en buurten 2024 2024</span></span>
<span><span class="co">#&gt; 1081   85618NED Kerncijfers wijken en buurten 2023 2023</span></span>
<span><span class="co">#&gt; 1082   85318NED Kerncijfers wijken en buurten 2022 2022</span></span>
<span><span class="co">#&gt; 1083   85039NED Kerncijfers wijken en buurten 2021 2021</span></span>
<span><span class="co">#&gt; 1084   84799NED Kerncijfers wijken en buurten 2020 2020</span></span>
<span><span class="co">#&gt; 1085   84583NED Kerncijfers wijken en buurten 2019 2019</span></span>
<span><span class="co">#&gt; 1086   84286NED Kerncijfers wijken en buurten 2018 2018</span></span>
<span><span class="co">#&gt; 3843   83765NED Kerncijfers wijken en buurten 2017 2017</span></span>
<span><span class="co">#&gt; 3844   83487NED Kerncijfers wijken en buurten 2016 2016</span></span>
<span><span class="co">#&gt; 3845   83220NED Kerncijfers wijken en buurten 2015 2015</span></span>
<span><span class="co">#&gt; 3846   82931NED Kerncijfers wijken en buurten 2014 2014</span></span>
<span><span class="co">#&gt; 3847   82339NED Kerncijfers wijken en buurten 2013 2013</span></span>
<span><span class="co">#&gt; 3850   80868ned Kerncijfers wijken en buurten 2003 2003</span></span>
<span><span class="co">#&gt; 3851   70139NED Kerncijfers wijken en buurten 2001 2001</span></span>
<span><span class="co">#&gt; 3852      37681 Kerncijfers wijken en buurten 1999 1999</span></span>
<span><span class="co">#&gt; 3853      37515 Kerncijfers wijken en buurten 1997 1997</span></span>
<span><span class="co">#&gt; 3854      37108 Kerncijfers wijken en buurten 1995 1995</span></span></code></pre></div>
<p>Het package <code>Grenswijzigen</code> is te gebruiken voor de jaren
2016 en later. Laten we daarom alle data ophalen van 2016 tot en met
2024:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="co"># find all relevant identifiers from 2016 onwards</span></span>
<span><span class="va">ids</span> <span class="op">&lt;-</span> <span class="va">df.catalog</span><span class="op">$</span><span class="va">Identifier</span><span class="op">[</span><span class="va">df.catalog</span><span class="op">$</span><span class="va">Jaar</span> <span class="op">&gt;=</span> <span class="fl">2016</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># create empty data-frame to be filled</span></span>
<span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># loop over all id's </span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">id</span> <span class="kw">in</span> <span class="va">ids</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">df</span>,</span>
<span>    <span class="co"># download data, filter on 'Gemeente' and select relevant columns</span></span>
<span>    <span class="fu">cbsodataR</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/cbsodataR/man/cbs_get_data.html" class="external-link">cbs_get_data</a></span><span class="op">(</span></span>
<span>      id<span class="op">=</span><span class="va">id</span>,</span>
<span>      select<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WijkenEnBuurten"</span>, <span class="st">"AantalInwoners_5"</span>, <span class="st">"k_65JaarOfOuder_12"</span><span class="op">)</span>,</span>
<span>      WijkenEnBuurten <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/cbsodataR/man/has_substring.html" class="external-link">has_substring</a></span><span class="op">(</span><span class="st">"GM"</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/pkg/cbsodataR/man/has_substring.html" class="external-link">has_substring</a></span><span class="op">(</span><span class="st">"WK"</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/cbsodataR/man/cbs_add_label_columns.html" class="external-link">cbs_add_label_columns</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="co"># add a 'Year' column to keep track of the year the data is from</span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        Year <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\D"</span>, <span class="st">""</span>, <span class="va">df.catalog</span><span class="op">[</span><span class="va">df.catalog</span><span class="op">[</span><span class="st">"Identifier"</span><span class="op">]</span><span class="op">==</span><span class="va">id</span>, <span class="st">"Title"</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 5</span></span></span>
<span><span class="co">#&gt;   WijkenEnBuurten WijkenEnBuurten_label AantalInwoners_5 k_65JaarOfOuder_12</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">"</span>GM1680    <span style="color: #949494;">"</span>    Aa en Hunze                      <span style="text-decoration: underline;">25</span>845               <span style="text-decoration: underline;">7</span>368</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> <span style="color: #949494;">"</span>WK168000  <span style="color: #949494;">"</span>    Wijk 00 Annen                     <span style="text-decoration: underline;">3</span>590               <span style="text-decoration: underline;">1</span>015</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> <span style="color: #949494;">"</span>WK168001  <span style="color: #949494;">"</span>    Wijk 01 Eext                      <span style="text-decoration: underline;">1</span>460                355</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> <span style="color: #949494;">"</span>WK168002  <span style="color: #949494;">"</span>    Wijk 02 Anloo                      390                100</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> <span style="color: #949494;">"</span>WK168003  <span style="color: #949494;">"</span>    Wijk 03 Gasteren                   390                140</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> <span style="color: #949494;">"</span>WK168004  <span style="color: #949494;">"</span>    Wijk 04 Anderen                    260                 65</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 1 more variable: Year &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Op basis van de opgehaalde data is het vrij eenvoudig inzichtelijk te
maken hoe het aantal gemeenten afneemt in de laatste jaren:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># explore the number of municipalities</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^GM"</span>, <span class="va">WijkenEnBuurten</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"dodgerblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Aantal Nederlandse gemeenten per jaar"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Aantal gemeenten"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Jaren"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">count</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    stat <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>    vjust<span class="op">=</span><span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="grenswijzigen_files/figure-html/aantal_gemeenten-1.png" width="100%"></p>
<p>En, zoals al eerder opgemerkt, neemt het aantal wijken de laatste
jaren toe. Dit heeft vermoedelijk te maken met de behoefte om binnen
grotere gemeenten toch zinvolle gebiedsopdelingen te kunnen blijven
maken.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^WK"</span>, <span class="va">WijkenEnBuurten</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">Year</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>fill<span class="op">=</span><span class="st">"dodgerblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Aantal Nederlandse wijken per jaar"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Aantal wijken"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Jaren"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">count</span> <span class="op">+</span> <span class="fl">2</span><span class="op">)</span>, label <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">count</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    stat <span class="op">=</span> <span class="st">"count"</span>,</span>
<span>    vjust<span class="op">=</span><span class="fl">2</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="grenswijzigen_files/figure-html/aantal_wijken-1.png" width="100%"></p>
<p>Als een gevolg van deze gemeentelijke herindelingen zijn plotselinge
sprongen te zien in de demografische gegevens, zoals weergegeven in de
grafiek hieronder. Het aantal inwoners in Vught lijkt plotseling te
vermeerderen met circa 5000 vanwege de gedeeltelijke overname van de
verdwenen gemeente Haaren. Ook voor nieuw gevormde gemeenten zoals
Eemsdelta zijn geen historische gegevens beschikbaar. Het is duidelijk
dat dergelijke interrupties het moeilijk maken om data over de jaren
heen met elkaar te vergelijken. Trends in mogelijk demografische
ontwikkelingen zijn moeilijk te ontwaren.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># show population of selected municipalities</span></span>
<span><span class="va">selected_municipalities</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Vught"</span>, <span class="st">"Eemsdelta"</span>, <span class="st">"Wageningen"</span>, <span class="st">"Montferland"</span>, <span class="st">"Gorinchem"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">WijkenEnBuurten_label</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">selected_municipalities</span><span class="op">)</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="va">Year</span>, </span>
<span>    y<span class="op">=</span><span class="va">AantalInwoners_5</span>, </span>
<span>    color<span class="op">=</span><span class="va">WijkenEnBuurten_label</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Inwoners per jaar"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Inwoneraantal"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Gemeente"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> </span>
<span><span class="co">#&gt; Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Please use `linewidth` instead.</span></span>
<span><span class="co">#&gt; <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">#&gt; <span style="color: #555555;">generated.</span></span></span></code></pre></div>
<p><img src="grenswijzigen_files/figure-html/uncorrected_population-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="oplossing">Oplossing<a class="anchor" aria-label="anchor" href="#oplossing"></a>
</h2>
<div class="section level3">
<h3 id="installatie">Installatie<a class="anchor" aria-label="anchor" href="#installatie"></a>
</h3>
<p>Het pakket van <code>grenswijzigingen</code> kan geÃ¯nstalleerd worden
vanuit GitHub als:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the development version from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"reidhin/grenswijzigen"</span><span class="op">)</span> </span></code></pre></div>
<p>Indien the pakket <code>grenswijzigingen</code> samen met de
vignettes moet worden geÃ¯nstalleerd vanuit Github dan kan het volgende
commando gebruikt worden:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install the development version from GitHub, explicitly requesting vignettes</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span></span>
<span>  <span class="st">"reidhin/grenswijzigen"</span>, </span>
<span>  dependencies <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>  build_vignettes <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Indien gewenst kan de gehele code ook vanuit GitHub gecloned
worden.</p>
<p>De hoofdfunctie voor het uitvoeren van de code is de functie
<code>wrapper_vertaal_naar_peiljaar</code> in het bestand
grenswijzigingen.R. Indicatoren die bestaan uit aantallen (bijvoorbeeld
aantal inwoners in de wijk of aantal 65-plussers in de wijk) worden
intern op een andere manier behandeld dan indicatoren die bestaan uit
percentages of aandelen (bijvoorbeeld gemiddelde huishoudgrootte of
aandeel arbeidsongeschikten per wijk). De functie
<code>wrapper_vertaal_naar_peiljaar</code> probeert op basis van
kolomnamen zelf in te schatten of het om aantallen of aandelen gaat.</p>
</div>
<div class="section level3">
<h3 id="visualisatie-wijzigingen">Visualisatie wijzigingen<a class="anchor" aria-label="anchor" href="#visualisatie-wijzigingen"></a>
</h3>
<p>Als voorbeeld is hieronder de verandering in gemeenten voor de jaren
2020 naar 2021 weergegeven. Het totaal aantal gemeenten neemt af van 355
in het jaar 2020 naar 352 in het jaar 2021. De drie noordelijke
gemeenten Appingedam, Loppersum en Delfzijl gaan op in een nieuwe
gemeente met de naam Eemsdelta. De gemeente Haaren verdwijnt van 2020
naar 2021 in zijn geheel en gaat op in de vier gemeenten Boxtel,
Oisterwijk, Tilburg, en Vught. In het Sankey diagram hieronder is
grafisch weergegeven hoe de adressen verschuiven tussen de gemeenten van
2020 naar 2021. Naast de bovengenoemde gemeenten gaat er een enkel adres
van de gemeente Noordenveld naar de buurgemeente Westerveld,
vermoedelijk vanwege een grenscorrectie.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://reidhin.github.io/grenswijzigen/">grenswijzigen</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://christophergandrud.github.io/networkD3/" class="external-link">networkD3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span><span class="va">grenswijziging_toevoeging_gemeente_van_2020_naar_2021</span></span>
<span><span class="va">df.links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, </span>
<span>  target<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  source<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df.nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Year<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2020</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(^GM)"</span>, <span class="st">""</span>, <span class="va">WijkenEnBuurten</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sort<span class="op">=</span><span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df.links</span> <span class="op">&lt;-</span> <span class="va">df.links</span><span class="op">[</span><span class="va">df.links</span><span class="op">$</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html" class="external-link">sankeyNetwork</a></span><span class="op">(</span></span>
<span>  Links <span class="op">=</span> <span class="va">df.links</span>, </span>
<span>  Nodes <span class="op">=</span> <span class="va">df.nodes</span>, </span>
<span>  Source <span class="op">=</span> <span class="st">'source'</span>,</span>
<span>  Target <span class="op">=</span> <span class="st">'target'</span>, </span>
<span>  Value <span class="op">=</span> <span class="st">'value'</span>, </span>
<span>  NodeID <span class="op">=</span> <span class="st">'WijkenEnBuurten_label'</span>,</span>
<span>  fontSize <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-ac96cb3ee4656e2e9ec3" style="width:100%;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-ac96cb3ee4656e2e9ec3">{"x":{"links":{"source":[7,8,9,10,11,11,11,11,12,13,14,15,15,16],"target":[6,6,6,0,0,1,2,3,1,2,3,4,5,5],"value":[6287,12064,4491,13528,881,2308,541,2009,11832,103460,11791,13977,2,26494]},"nodes":{"name":["Boxtel","Oisterwijk","Tilburg","Vught","Noordenveld","Westerkwartier","Eemsdelta","Appingedam","Delfzijl","Loppersum","Boxtel","Haaren","Oisterwijk","Tilburg","Vught","Noordenveld","Westerkwartier"],"group":["Boxtel","Oisterwijk","Tilburg","Vught","Noordenveld","Westerkwartier","Eemsdelta","Appingedam","Delfzijl","Loppersum","Boxtel","Haaren","Oisterwijk","Tilburg","Vught","Noordenveld","Westerkwartier"]},"options":{"NodeID":"WijkenEnBuurten_label","NodeGroup":"WijkenEnBuurten_label","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script><p>Als tweede voorbeeld is hieronder de verandering in de Wageningse
wijken van 2017 naar 2018 weergegeven. In 2017 heeft Wageningen slechts
twee wijken: <em>Stedelijk gebied</em> en <em>Landelijk gebied</em>. In
2018 heeft Wageningen de wijkindeling verfijnd naar twaalf wijken. In
het Sankey diagram hieronder is grafisch weergegeven hoe de adressen
verschuiven tussen de wijken van 2017 naar 2018. De wijzigingen zijn
tamelijk complex, in de zin dat de nieuwe wijken zowel uit adressen uit
stedelijk als uit landelijk gebied kunnen zijn samengesteld.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://reidhin.github.io/grenswijzigen/">grenswijzigen</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://christophergandrud.github.io/networkD3/" class="external-link">networkD3</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span><span class="va">grenswijziging_toevoeging_wijk_van_2017_naar_2018</span></span>
<span><span class="co"># take only Wageningen (gwb_code begint met 0289)</span></span>
<span><span class="va">mat</span> <span class="op">&lt;-</span> <span class="va">mat</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^0289"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^0289"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">df.links</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  value<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/vector.html" class="external-link">as.vector</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, </span>
<span>  target<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>, </span>
<span>  source<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span>, each<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df.nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    Year<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2018</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2017</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"(^WK)"</span>, <span class="st">""</span>, <span class="va">WijkenEnBuurten</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sort<span class="op">=</span><span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="va">df.links</span> <span class="op">&lt;-</span> <span class="va">df.links</span><span class="op">[</span><span class="va">df.links</span><span class="op">$</span><span class="va">value</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="op">]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/networkD3/man/sankeyNetwork.html" class="external-link">sankeyNetwork</a></span><span class="op">(</span></span>
<span>  Links <span class="op">=</span> <span class="va">df.links</span>, </span>
<span>  Nodes <span class="op">=</span> <span class="va">df.nodes</span>, </span>
<span>  Source <span class="op">=</span> <span class="st">'source'</span>,</span>
<span>  Target <span class="op">=</span> <span class="st">'target'</span>, </span>
<span>  Value <span class="op">=</span> <span class="st">'value'</span>, </span>
<span>  NodeID <span class="op">=</span> <span class="st">'WijkenEnBuurten_label'</span>,</span>
<span>  fontSize <span class="op">=</span> <span class="fl">12</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-e5c8c404fe174e4c81bd" style="width:100%;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-e5c8c404fe174e4c81bd">{"x":{"links":{"source":[12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13],"target":[0,1,2,3,4,5,6,7,8,9,11,0,1,4,7,9,10,11],"value":[1661,427,1120,876,1175,3716,2371,1330,1523,1225,77,99,476,614,19,1,514,352]},"nodes":{"name":["Noordwest","Wageningen Universiteit","De Weiden en Boomgaarden","De Horsten","Kortenoord","De Buurt","Boven- en Benedenbuurt","Nude","Centrum","Veluvia-Hamelakkers","Wageningen-Hoog","Buitengebied","Wijk 00 Stedelijk gebied","Wijk 01 Landelijk gebied"],"group":["Noordwest","Wageningen Universiteit","De Weiden en Boomgaarden","De Horsten","Kortenoord","De Buurt","Boven- en Benedenbuurt","Nude","Centrum","Veluvia-Hamelakkers","Wageningen-Hoog","Buitengebied","Wijk 00 Stedelijk gebied","Wijk 01 Landelijk gebied"]},"options":{"NodeID":"WijkenEnBuurten_label","NodeGroup":"WijkenEnBuurten_label","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":15,"nodePadding":10,"units":"","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level3">
<h3 id="toepassen-grenscorrecties">Toepassen grenscorrecties<a class="anchor" aria-label="anchor" href="#toepassen-grenscorrecties"></a>
</h3>
<p>Het CBS rapporteert de wijzigingen in gemeentegrenzen en hoe
gemeentekenmerken over de jaren heen vergeleken kunnen worden. Voor de
wijkgrenzen is er geen jaarlijkse publicatie over hoe wijkkenmerken over
de jaren heen vergeleken kunnen worden. Het CBS geeft enkel aan of de
cijfers vergeleken mogen worden met het jaar daarvoor. Als de cijfers
niet vergelijkbaar zijn met het vorige jaar wordt niet aangegeven hoe
deze getransformeerd moeten worden.</p>
<p>In principe kan het CBS of de gemeente op basis van zogenaamde
microdata exact uitrekenen wat de wijkkenmerken van vorige jaren zijn
voor de huidige wijkgrenzen. Deze microdata bestaat uit kenmerken op
persoons- of huishoudensniveau. Voor het rekenen met microdata moeten de
privacy regels goed gewaarborgd worden.</p>
<p>Indien er geen beschikking is over microdata, of als men niet met
privacy gevoelige data wil of kan rekenen, kunnen er toch schattingen
worden gemaakt van de wijkkenmerken van vorige jaren met de huidige
wijkgrenzen. Deze repository bevat R-scripts waarmee dergelijke
schattingen gemaakt kunnen worden.</p>
<p>Zie deze link (voor het laatst bijgewerkt in 2022) voor een dashboard
die grenswijzigingen inzichtelijk maakt <a href="https://datamonitoringvng.shinyapps.io/grenswijzigingen/" class="external-link">https://datamonitoringvng.shinyapps.io/grenswijzigingen/</a></p>
<p>De code hieronder geeft aan hoe de data uit verschillende jaren met
verschillende gemeentelijke indelingen omgezet kan worden naar een
bepaald peiljaar. Hieronder is voor het peiljaar 2024 gekozen. Er moet
worden aangegeven welk model wordt gekozen voor de omzetting. In dit
geval is voor <code>model.2</code> gekozen. Ook het regionale niveau en
of de variabelen als aantallen of percentages moeten worden behandeld
kan worden aangegeven.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Transform the historic data to 2024</span></span>
<span><span class="va">df_transformed</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/wrapper_vertaal_naar_peiljaar.html">wrapper_vertaal_naar_peiljaar</a></span><span class="op">(</span></span>
<span>  </span>
<span>  <span class="co"># the package requires 'wijkcode' and 'jaar' as column names</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span></span>
<span>    <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span></span>
<span>      wijkcode <span class="op">=</span> <span class="va">WijkenEnBuurten</span>,</span>
<span>      gemeentenaam <span class="op">=</span> <span class="va">WijkenEnBuurten_label</span>,</span>
<span>      jaar <span class="op">=</span> <span class="va">Year</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^GM"</span>, <span class="va">wijkcode</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>wijkcode<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/trimws.html" class="external-link">trimws</a></span><span class="op">(</span><span class="va">wijkcode</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  peiljaar <span class="op">=</span> <span class="fl">2024</span>,</span>
<span>  model<span class="op">=</span><span class="st">"model.2"</span>,</span>
<span>  regionaalniveau <span class="op">=</span> <span class="st">"gemeente"</span>,</span>
<span>  kolommen_aantal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AantalInwoners_5"</span>, <span class="st">"k_65JaarOfOuder_12"</span><span class="op">)</span></span>
<span><span class="op">)</span> </span>
<span><span class="co">#&gt; ----------------------------</span></span>
<span><span class="co">#&gt; De volgende kolommen worden niet meegenomen in de grensomzetting</span></span>
<span><span class="co">#&gt; wijkcode</span></span>
<span><span class="co">#&gt; gemeentenaam</span></span>
<span><span class="co">#&gt; jaar</span></span>
<span><span class="co">#&gt; gwb_code</span></span>
<span><span class="co">#&gt; ----------------------------</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span><span class="co">#&gt; [1] "Aantal rijen omgezette data-frame: 342"</span></span>
<span></span>
<span><span class="co"># show that we have equal numbers of municipalities each year</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">df_transformed</span><span class="op">$</span><span class="va">jaar</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; 2016 2017 2018 2019 2020 2021 2022 2023 2024 </span></span>
<span><span class="co">#&gt;  342  342  342  342  342  342  342  342  342</span></span></code></pre></div>
<p>De omzetting van de dat leidt tot een dataset die over de jaren 2016
tot en met 2024 met elkaar vergeleken kan worden. Voor de jaren waarbij
de gemeente nog niet bestond in de huidige vorm, worden de getallen
ingeschat volgens <code>model.2</code> zoals in de code hierboven
gerealiseerd wordt. Dit alles leidt tot de grafiek hieronder. Het is
duidelijk dat demografische trends nu beter waarneembaar zijn.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># show how the transformed data looks like</span></span>
<span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_transformed</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gemeentenaam</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">selected_municipalities</span><span class="op">)</span>,</span>
<span>  mapping <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>    x<span class="op">=</span><span class="va">jaar</span>, </span>
<span>    y<span class="op">=</span><span class="va">AantalInwoners_5</span>, </span>
<span>    color<span class="op">=</span><span class="va">gemeentenaam</span>,</span>
<span>    linetype<span class="op">=</span><span class="va">berekend</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.5</span>, linetype<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Inwoners per jaar"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Inwoneraantal"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Gemeente"</span>,</span>
<span>    linetype <span class="op">=</span> <span class="st">"Oorsprong gegevens"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_linetype_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"solid"</span>, <span class="st">"dotted"</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Daadwerkelijk"</span>, <span class="st">"Geschat"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="grenswijzigen_files/figure-html/corrected_population-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="modellen-voor-grenswijzigen">Modellen voor grenswijzigen<a class="anchor" aria-label="anchor" href="#modellen-voor-grenswijzigen"></a>
</h3>
<p>Alle modellen zijn gebaseerd op het volgen van adressen door de tijd
heen. Hierdoor kan worden achterhaalt bij welke wijk een adres hoort op
in elk jaar. Vervolgens zijn er verschillende manieren om deze
informatie te benutten. In deze repository zijn er drie modellen
geÃ¯mplementeerd voor het uitvoeren van grenswijzigingen.</p>
<ul>
<li><p>Model.0 gaat uit van een uniforme verdeling van wijkkenmerken
over de wijk heen. Dat wil zeggen dat wordt aangenomen dat kenmerken,
bijvoorbeeld het aantal 65-plussers, gelijkelijk verdeeld zijn over de
wijk. Bij het delen van de wijk in kleinere stukken kunnen deze
kenmerken dan evenredig met het aantal adressen in deze stukken worden
toegekend. In Model.0 zijn adressen gedefinieerd als postcode +
huisnummer. Huisnummertoevoegingen en gebruiksfunctie van adressen
worden niet meegenomen. Model.0 is daarmee een heel toegankelijk model
dat een redelijk goede grenswijziging uitvoerd, maar dat faalt in geval
van wijken met veel huisnummertoevoegingen (bijvoorbeeld hoogbouw of
flats) en wijken met veel adressen zonder woonfunctie (bijvoorbeeld
winkels, scholen en fabrieken).</p></li>
<li><p>Model.1 werkt gelijk aan Model.0 maar neemt daarentegen wel de
huisnummertoevoeging en gebruiksfunctie van het adres mee. In Model.1
worden alleen adressen met een woonfunctie beschouwt. Daarmee presteert
Model.1 aanzienlijk beter dan Model.0 voor wijken met veel
huisnummertoevoegingen en andere gebruiksfuncties dan wonen. Model.1
gaat echter nog wel altijd uit van een uniforme verdeling van de
wijkkenmerken over de wijk heen. Daarnaast wordt er een VNG api gebruikt
om de huisnummertoevoegingen en gebruiksfunctie te achterhalen Dat kost
het tamelijk veel tijd om uit te voeren voor alle adressen in Nederland.
Daarom zijn ook vooraf berekende omzetmatrices beschikbaar gesteld in
deze repository.</p></li>
<li><p>Model.2 neemt een andere benadering. Hier worden adressen
opgedeeld in blokken gedefinieerd door de overlappingen tussen wijken in
het ene jaar en de wijken in het volgende jaar. Voor elk blok wordt een
variabele gedefinieerd die het gemiddelde van een wijkkenmerk in dat
blok weergeeft. Voor deze variabelen wordt een stelsel formules
opgesteld zodat de sommen van de adressen maal de gemiddelden gelijk
zijn aan de wijkkenmerken zoals gepubliceerd door het CBS. Daarnaast
wordt aangenomen dat deze gemiddelden van jaar tot jaar nauwelijks
wijzigen. Dat lijkt een redelijke aanname: bijvoorbeeld het gemiddelde
aantal 65-plussers per adres zal van jaar tot jaar ongeveer gelijk zijn.
Dit stelsel vergelijkingen wordt opgelost wat tot grensgewijzigde data
leidt. In dit model wordt eveneens uitgegaan van adressen met
huisnummertoevoegingen en woonfunctie.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="beperkingen">Beperkingen<a class="anchor" aria-label="anchor" href="#beperkingen"></a>
</h3>
<p>In de gebruikte benadering wordt aangenomen dat de demografische
kenmerken van jaar op jaar op een groepje adressen relatief constant is.
Op het moment dat een wijk of gemeente onder sterke ontwikkeling
onderhevig is, zal deze benadering minder goed werken. Daarbij kan
gedacht worden aan grootschalige nieuwbouw of herbestemming van
bestaande panden.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Hans Weda.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
